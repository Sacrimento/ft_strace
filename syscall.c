#include "syscall.h"

t_syscall_info get_syscall_info(int id)
{
    static const t_syscall_info  syscalls_infos[] =
    {
        {"read", 3, {UINT, STRING, ULONG}, LONG},
        {"write", 3, {UINT, STRING, ULONG}, LONG},
        {"open", 3, {STRING, INT, INT}, LONG},
        {"close", 1, {UINT}, LONG},
        {"stat", 2, {STRING, ADDR}, LONG},
        {"fstat", 2, {UINT, ADDR}, LONG},
        {"lstat", 2, {STRING, ADDR}, LONG},
        {"poll", 3, {ADDR, UINT, LONG}, LONG},
        {"lseek", 3, {UINT, ADDR, UINT}, LONG},
        {"mmap", 6, {ULONG, ULONG, ULONG, ULONG, ULONG, ULONG}, LONG},
        {"mprotect", 3, {ULONG, ULONG, ULONG}, LONG},
        {"munmap", 2, {ULONG, ULONG}, LONG},
        {"brk", 1, {ULONG}, LONG},
        {"rt_sigaction", 4, {INT, ADDR, ADDR, ULONG}, LONG},
        {"rt_sigprocmask", 4, {INT, ADDR, ADDR, ULONG}, LONG},
        {"rt_sigreturn", 1, {ULONG}, LONG},
        {"ioctl", 3, {UINT, UINT, ULONG}, LONG},
        {"pread64", 4, {ULONG, STRING, ULONG, ADDR}, LONG},
        {"pwrite64", 4, {UINT, STRING, ULONG, ADDR}, LONG},
        {"readv", 3, {ULONG, ADDR, ULONG}, LONG},
        {"writev", 3, {ULONG, ADDR, ULONG}, LONG},
        {"access", 2, {STRING, INT}, LONG},
        {"pipe", 1, {INT}, LONG},
        {"select", 5, {INT, ADDR, ADDR, ADDR, ADDR}, LONG},
        {"sched_yield", 0, {}, LONG},
        {"mremap", 5, {ULONG, ULONG, ULONG, ULONG, ULONG}, LONG},
        {"msync", 3, {ULONG, ULONG, INT}, LONG},
        {"mincore", 3, {ULONG, ULONG, STRING}, LONG},
        {"madvise", 3, {ULONG, ULONG, INT}, LONG},
        {"shmget", 3, {ADDR, ULONG, INT}, LONG},
        {"shmat", 3, {INT, STRING, INT}, LONG},
        {"shmctl", 3, {INT, INT, ADDR}, LONG},
        {"dup", 1, {UINT}, LONG},
        {"dup2", 2, {UINT, UINT}, LONG},
        {"pause", 0, {}, LONG},
        {"nanosleep", 2, {ADDR, ADDR}, LONG},
        {"getitimer", 2, {INT, ADDR}, LONG},
        {"alarm", 1, {UINT}, LONG},
        {"setitimer", 3, {INT, ADDR, ADDR}, LONG},
        {"getpid", 0, {}, LONG},
        {"sendfile", 4, {INT, INT, ADDR, ULONG}, LONG},
        {"socket", 3, {INT, INT, INT}, LONG},
        {"connect", 3, {INT, ADDR, INT}, LONG},
        {"accept", 3, {INT, ADDR, INT}, LONG},
        {"sendto", 6, {INT, ADDR, ULONG, ADDR, ADDR, INT}, LONG},
        {"recvfrom", 6, {INT, ADDR, ULONG, ADDR, ADDR, INT}, LONG},
        {"sendmsg", 3, {INT, ADDR, ADDR}, LONG},
        {"recvmsg", 3, {INT, ADDR, UINT}, LONG},
        {"shutdown", 2, {INT, INT}, LONG},
        {"bind", 3, {INT, ADDR, INT}, LONG},
        {"listen", 2, {INT, INT}, LONG},
        {"getsockname", 3, {INT, ADDR, INT}, LONG},
        {"getpeername", 3, {INT, ADDR, INT}, LONG},
        {"socketpair", 4, {INT, INT, INT, INT}, LONG},
        {"setsockopt", 5, {INT, INT, INT, STRING, INT}, LONG},
        {"getsockopt", 5, {INT, INT, INT, STRING, INT}, LONG},
        {"clone", 5, {ULONG, ULONG, ADDR, ADDR, UINT}, LONG},
        {"fork", 0, {}, LONG},
        {"vfork", 0, {}, LONG},
        {"execve", 3, {STRING, STRING, STRING}, LONG},
        {"exit", 1, {INT}, LONG},
        {"wait4", 4, {ADDR, INT, INT, ADDR}, LONG},
        {"kill", 2, {ADDR, INT}, LONG},
        {"uname", 1, {ADDR}, LONG},
        {"semget", 3, {ADDR, INT, INT}, LONG},
        {"semop", 3, {INT, ADDR, ADDR}, LONG},
        {"semctl", 4, {INT, INT, INT, ADDR}, LONG},
        {"shmdt", 1, {STRING}, LONG},
        {"msgget", 2, {ADDR, INT}, LONG},
        {"msgsnd", 4, {INT, ADDR, ULONG, INT}, LONG},
        {"msgrcv", 5, {INT, ADDR, ULONG, LONG, INT}, LONG},
        {"msgctl", 3, {INT, INT, ADDR}, LONG},
        {"fcntl", 3, {UINT, UINT, ULONG}, LONG},
        {"flock", 2, {UINT, UINT}, LONG},
        {"fsync", 1, {UINT}, LONG},
        {"fdatasync", 1, {UINT}, LONG},
        {"truncate", 2, {STRING, LONG}, LONG},
        {"ftruncate", 2, {UINT, ULONG}, LONG},
        {"getdents", 3, {UINT, ADDR, UINT}, LONG},
        {"getcwd", 2, {STRING, ULONG}, LONG},
        {"chdir", 1, {STRING}, LONG},
        {"fchdir", 1, {UINT}, LONG},
        {"rename", 2, {STRING, STRING}, LONG},
        {"mkdir", 2, {STRING, INT}, LONG},
        {"rmdir", 1, {STRING}, LONG},
        {"creat", 2, {STRING, INT}, LONG},
        {"link", 2, {STRING, STRING}, LONG},
        {"unlink", 1, {STRING}, LONG},
        {"symlink", 2, {STRING, STRING}, LONG},
        {"readlink", 3, {STRING, STRING, INT}, LONG},
        {"chmod", 2, {STRING, ADDR}, LONG},
        {"fchmod", 2, {UINT, ADDR}, LONG},
        {"chown", 3, {STRING, ADDR, ADDR}, LONG},
        {"fchown", 3, {UINT, ADDR, ADDR}, LONG},
        {"lchown", 3, {STRING, ADDR, ADDR}, LONG},
        {"umask", 1, {INT}, LONG},
        {"gettimeofday", 2, {ADDR, ADDR}, LONG},
        {"getrlimit", 2, {UINT, ADDR}, LONG},
        {"getrusage", 2, {INT, ADDR}, LONG},
        {"sysinfo", 1, {ADDR}, LONG},
        {"times", 1, {ADDR}, LONG},
        {"ptrace", 4, {LONG, LONG, ULONG, ULONG}, LONG},
        {"getuid", 0, {}, LONG},
        {"syslog", 3, {INT, STRING, INT}, LONG},
        {"getgid", 0, {}, LONG},
        {"setuid", 1, {ADDR}, LONG},
        {"setgid", 1, {ADDR}, LONG},
        {"geteuid", 0, {}, LONG},
        {"getegid", 0, {}, LONG},
        {"setpgid", 2, {ADDR, ADDR}, LONG},
        {"getppid", 0, {}, LONG},
        {"getpgrp", 0, {}, LONG},
        {"setsid", 0, {}, LONG},
        {"setreuid", 2, {ADDR, ADDR}, LONG},
        {"setregid", 2, {ADDR, ADDR}, LONG},
        {"getgroups", 2, {INT, ADDR}, LONG},
        {"setgroups", 2, {INT, ADDR}, LONG},
        {"setresuid", 3, {ADDR, ADDR, ADDR}, LONG},
        {"getresuid", 3, {ADDR, ADDR, ADDR}, LONG},
        {"setresgid", 3, {ADDR, ADDR, ADDR}, LONG},
        {"getresgid", 3, {ADDR, ADDR, ADDR}, LONG},
        {"getpgid", 1, {ADDR}, LONG},
        {"setfsuid", 1, {ADDR}, LONG},
        {"setfsgid", 1, {ADDR}, LONG},
        {"getsid", 1, {ADDR}, LONG},
        {"capget", 2, {ADDR, ADDR}, LONG},
        {"capset", 2, {ADDR, ADDR}, LONG},
        {"rt_sigpending", 2, {ADDR, ULONG}, LONG},
        {"rt_sigtimedwait", 4, {ADDR, ADDR, ADDR, ULONG}, LONG},
        {"rt_sigqueueinfo", 3, {ADDR, INT, ADDR}, LONG},
        {"rt_sigsuspend", 2, {ADDR, ULONG}, LONG},
        {"sigaltstack", 2, {ADDR, ADDR}, LONG},
        {"utime", 2, {STRING, ADDR}, LONG},
        {"mknod", 3, {STRING, ADDR, ADDR}, LONG},
        {"uselib", 1, {ADDR}, LONG},
        {"personality", 1, {UINT}, LONG},
        {"ustat", 2, {ADDR, ADDR}, LONG},
        {"statfs", 2, {STRING, ADDR}, LONG},
        {"fstatfs", 2, {UINT, ADDR}, LONG},
        {"sysfs", 3, {INT, ULONG, ULONG}, LONG},
        {"getpriority", 2, {INT, INT}, LONG},
        {"setpriority", 3, {INT, INT, INT}, LONG},
        {"sched_setparam", 2, {ADDR, ADDR}, LONG},
        {"sched_getparam", 2, {ADDR, ADDR}, LONG},
        {"sched_setscheduler", 3, {ADDR, INT, ADDR}, LONG},
        {"sched_getscheduler", 1, {ADDR}, LONG},
        {"sched_get_priority_max", 1, {INT}, LONG},
        {"sched_get_priority_min", 1, {INT}, LONG},
        {"sched_rr_get_interval", 2, {ADDR, INT}, LONG},
        {"mlock", 2, {ULONG, ULONG}, LONG},
        {"munlock", 2, {ULONG, ULONG}, LONG},
        {"mlockall", 1, {INT}, LONG},
        {"munlockall", 0, {}, LONG},
        {"vhangup", 0, {}, LONG},
        {"modify_ldt", 3, {INT, ADDR, ULONG}, LONG},
        {"pivot_root", 2, {STRING, STRING}, LONG},
        {"_sysctl", 1, {ADDR}, LONG},
        {"prctl", 5, {INT, ULONG, ULONG, ULONG, ULONG}, LONG},
        {"arch_prctl", 3, {ADDR, INT, ULONG}, LONG},
        {"adjtimex", 1, {ADDR}, LONG},
        {"setrlimit", 2, {UINT, ADDR}, LONG},
        {"chroot", 1, {STRING}, LONG},
        {"sync", 0, {}, LONG},
        {"acct", 1, {STRING}, LONG},
        {"settimeofday", 2, {ADDR, ADDR}, LONG},
        {"mount", 5, {STRING, STRING, STRING, ULONG, ADDR}, LONG},
        {"umount2", 2, {STRING, INT}, LONG},
        {"swapon", 2, {STRING, INT}, LONG},
        {"swapoff", 1, {STRING}, LONG},
        {"reboot", 4, {INT, INT, UINT, ADDR}, LONG},
        {"sethostname", 2, {STRING, INT}, LONG},
        {"setdomainname", 2, {STRING, INT}, LONG},
        {"iopl", 2, {UINT, ADDR}, LONG},
        {"ioperm", 3, {ULONG, ULONG, INT}, LONG},
        {"create_module", 1, {ADDR}, LONG},
        {"init_module", 3, {ADDR, ULONG, STRING}, LONG},
        {"delete_module", 2, {ADDR, UINT}, LONG},
        {"get_kernel_syms", 1, {ADDR}, LONG},
        {"query_module", 1, {ADDR}, LONG},
        {"quotactl", 4, {UINT, STRING, ADDR, ADDR}, LONG},
        {"nfsservctl", 1, {ADDR}, LONG},
        {"getpmsg", 1, {ADDR}, LONG},
        {"putpmsg", 1, {ADDR}, LONG},
        {"afs_syscall", 1, {ADDR}, LONG},
        {"tuxcall", 1, {ADDR}, LONG},
        {"security", 1, {ADDR}, LONG},
        {"gettid", 0, {}, LONG},
        {"readahead", 3, {INT, ADDR, ULONG}, LONG},
        {"setxattr", 5, {STRING, STRING, ADDR, ULONG, INT}, LONG},
        {"lsetxattr", 5, {STRING, STRING, ADDR, ULONG, INT}, LONG},
        {"fsetxattr", 5, {INT, STRING, ADDR, ULONG, INT}, LONG},
        {"getxattr", 4, {STRING, STRING, ADDR, ULONG}, LONG},
        {"lgetxattr", 4, {STRING, STRING, ADDR, ULONG}, LONG},
        {"fgetxattr", 4, {INT, ADDR, ADDR, ULONG}, LONG},
        {"listxattr", 3, {STRING, STRING, ULONG}, LONG},
        {"llistxattr", 3, {STRING, STRING, ULONG}, LONG},
        {"flistxattr", 3, {INT, STRING, ULONG}, LONG},
        {"removexattr", 2, {STRING, STRING}, LONG},
        {"lremovexattr", 2, {STRING, STRING}, LONG},
        {"fremovexattr", 2, {INT, STRING}, LONG},
        {"tkill", 2, {ADDR, ADDR}, LONG},
        {"time", 1, {ADDR}, LONG},
        {"futex", 6, {ADDR, INT, ADDR, ADDR, ADDR, ADDR}, LONG},
        {"sched_setaffinity", 3, {ADDR, UINT, ULONG}, LONG},
        {"sched_getaffinity", 3, {ADDR, UINT, ULONG}, LONG},
        {"set_thread_area", 1, {ADDR}, LONG},
        {"io_setup", 2, {ADDR, ADDR}, LONG},
        {"io_destroy", 1, {ADDR}, LONG},
        {"io_getevents", 4, {ADDR, LONG, LONG, ADDR}, LONG},
        {"io_submit", 3, {ADDR, LONG, ADDR}, LONG},
        {"io_cancel", 3, {ADDR, ADDR, ADDR}, LONG},
        {"get_thread_area", 1, {ADDR}, LONG},
        {"lookup_dcookie", 3, {ADDR, LONG, LONG}, LONG},
        {"epoll_create", 1, {INT}, LONG},
        {"epoll_ctl_old", 1, {ADDR}, LONG},
        {"epoll_wait_old", 1, {ADDR}, LONG},
        {"remap_file_pages", 5, {ULONG, ULONG, ULONG, ULONG, ULONG}, LONG},
        {"getdents64", 3, {UINT, ADDR, UINT}, LONG},
        {"set_tid_address", 1, {INT}, LONG},
        {"restart_syscall", 0, {}, LONG},
        {"semtimedop", 4, {INT, ADDR, ADDR, ADDR}, LONG},
        {"fadvise64", 4, {INT, ADDR, ULONG, INT}, LONG},
        {"timer_create", 3, {ADDR, ADDR, ADDR}, LONG},
        {"timer_settime", 4, {ADDR, INT, ADDR, ADDR}, LONG},
        {"timer_gettime", 2, {ADDR, ADDR}, LONG},
        {"timer_getoverrun", 1, {ADDR}, LONG},
        {"timer_delete", 1, {ADDR}, LONG},
        {"clock_settime", 2, {ADDR, ADDR}, LONG},
        {"clock_gettime", 2, {ADDR, ADDR}, LONG},
        {"clock_getres", 2, {ADDR, ADDR}, LONG},
        {"clock_nanosleep", 4, {ADDR, INT, ADDR, ADDR}, LONG},
        {"exit_group", 1, {INT}, LONG},
        {"epoll_wait", 4, {INT, ADDR, INT, INT}, LONG},
        {"epoll_ctl", 4, {INT, INT, INT, ADDR}, LONG},
        {"tgkill", 3, {ADDR, ADDR, INT}, LONG},
        {"utimes", 2, {STRING, ADDR}, LONG},
        {"vserver", 1, {ADDR}, LONG},
        {"mbind", 6, {ULONG, ULONG, ULONG, ULONG, ULONG, ADDR}, LONG},
        {"set_mempolicy", 3, {INT, ULONG, ULONG}, LONG},
        {"get_mempolicy", 5, {INT, ULONG, ULONG, ULONG, ULONG}, LONG},
        {"mq_open", 4, {STRING, INT, ADDR, ADDR}, LONG},
        {"mq_unlink", 1, {STRING}, LONG},
        {"mq_timedsend", 5, {ADDR, STRING, ULONG, UINT, ADDR}, LONG},
        {"mq_timedreceive", 5, {ADDR, STRING, ULONG, UINT, ADDR}, LONG},
        {"mq_notify", 2, {ADDR, ADDR}, LONG},
        {"mq_getsetattr", 3, {ADDR, ADDR, ADDR}, LONG},
        {"kexec_load", 4, {ULONG, ULONG, ADDR, ULONG}, LONG},
        {"waitid", 5, {INT, ADDR, ADDR, INT, ADDR}, LONG},
        {"add_key", 4, {STRING, STRING, ADDR, ULONG}, LONG},
        {"request_key", 4, {STRING, STRING, STRING, ADDR}, LONG},
        {"keyctl", 5, {INT, ULONG, ULONG, ULONG, ULONG}, LONG},
        {"ioprio_set", 3, {INT, INT, INT}, LONG},
        {"ioprio_get", 2, {INT, INT}, LONG},
        {"inotify_init", 0, {}, LONG},
        {"inotify_add_watch", 3, {INT, STRING, ADDR}, LONG},
        {"inotify_rm_watch", 2, {INT, ADDR}, LONG},
        {"migrate_pages", 4, {ADDR, ULONG, ULONG, ULONG}, LONG},
        {"openat", 4, {INT, STRING, INT, INT}, LONG},
        {"mkdirat", 3, {INT, STRING, INT}, LONG},
        {"mknodat", 4, {INT, STRING, INT, ADDR}, LONG},
        {"fchownat", 5, {INT, STRING, ADDR, ADDR, INT}, LONG},
        {"futimesat", 3, {INT, STRING, ADDR}, LONG},
        {"newfstatat", 4, {INT, STRING, ADDR, INT}, LONG},
        {"unlinkat", 3, {INT, STRING, INT}, LONG},
        {"renameat", 4, {INT, STRING, INT, STRING}, LONG},
        {"linkat", 5, {INT, STRING, INT, STRING, INT}, LONG},
        {"symlinkat", 3, {STRING, INT, STRING}, LONG},
        {"readlinkat", 4, {INT, STRING, STRING, INT}, LONG},
        {"fchmodat", 3, {INT, STRING, ADDR}, LONG},
        {"faccessat", 3, {INT, STRING, INT}, LONG},
        {"pselect6", 6, {INT, ADDR, ADDR, ADDR, ADDR, ADDR}, LONG},
        {"ppoll", 5, {ADDR, UINT, ADDR, ADDR, ULONG}, LONG},
        {"unshare", 1, {ULONG}, LONG},
        {"set_robust_list", 2, {ADDR, ULONG}, LONG},
        {"get_robust_list", 3, {INT, ADDR, ULONG}, LONG},
        {"splice", 6, {INT, ADDR, INT, ADDR, ULONG, UINT}, LONG},
        {"tee", 4, {INT, INT, ULONG, UINT}, LONG},
        {"sync_file_range", 4, {LONG, ADDR, ADDR, LONG}, LONG},
        {"vmsplice", 4, {INT, ADDR, ULONG, UINT}, LONG},
        {"move_pages", 6, {ADDR, ULONG, ADDR, INT, INT, INT}, LONG},
        {"utimensat", 4, {INT, STRING, ADDR, INT}, LONG},
        {"epoll_pwait", 6, {INT, ADDR, INT, INT, ADDR, ULONG}, LONG},
        {"signalfd", 3, {INT, ADDR, ULONG}, LONG},
        {"timerfd_create", 2, {INT, INT}, LONG},
        {"eventfd", 1, {UINT}, LONG},
        {"fallocate", 4, {LONG, LONG, ADDR, ADDR}, LONG},
        {"timerfd_settime", 4, {INT, INT, ADDR, ADDR}, LONG},
        {"timerfd_gettime", 2, {INT, ADDR}, LONG},
        {"accept4", 4, {INT, ADDR, INT, INT}, LONG},
        {"signalfd4", 4, {INT, ADDR, ULONG, INT}, LONG},
        {"eventfd2", 2, {UINT, INT}, LONG},
        {"epoll_create1", 1, {INT}, LONG},
        {"dup3", 3, {UINT, UINT, INT}, LONG},
        {"pipe2", 2, {INT, INT}, LONG},
        {"inotify_init1", 1, {INT}, LONG},
        {"preadv", 5, {ULONG, ADDR, ULONG, ULONG, ULONG}, LONG},
        {"pwritev", 5, {ULONG, ADDR, ULONG, ULONG, ULONG}, LONG},
        {"rt_tgsigqueueinfo", 4, {ADDR, ADDR, INT, ADDR}, LONG},
        {"perf_event_open", 5, {ADDR, ADDR, INT, INT, ULONG}, LONG},
        {"recvmmsg", 5, {INT, ADDR, UINT, UINT, ADDR}, LONG},
        {"fanotify_init", 2, {UINT, UINT}, LONG},
        {"fanotify_mark", 5, {LONG, LONG, ADDR, LONG, LONG}, LONG},
        {"prlimit64", 4, {ADDR, UINT, ADDR, ADDR}, LONG},
        {"name_to_handle_at", 5, {INT, STRING, ADDR, INT, INT}, LONG},
        {"open_by_handle_at", 5, {INT, STRING, ADDR, INT, INT}, LONG},
        {"clock_adjtime", 2, {ADDR, ADDR}, LONG},
        {"syncfs", 1, {INT}, LONG},
        {"sendmmsg", 4, {INT, ADDR, UINT, UINT}, LONG},
        {"setns", 2, {INT, INT}, LONG},
        {"getcpu", 3, {ADDR, ADDR, ADDR}, LONG},
        {"process_vm_readv", 6, {ADDR, ADDR, ULONG, ADDR, ULONG, ULONG}, LONG},
        {"process_vm_writev", 6, {ADDR, ADDR, ULONG, ADDR, ULONG, ULONG}, LONG},
        {"kcmp", 5, {ADDR, ADDR, INT, ULONG, ULONG}, LONG},
        {"finit_module", 3, {INT, ADDR, INT}, LONG},
        {"sched_setattr", 3, {ADDR, ADDR, UINT}, LONG},
        {"sched_getattr", 4, {ADDR, ADDR, UINT, UINT}, LONG},
        {"renameat2", 5, {INT, ADDR, INT, ADDR, UINT}, LONG},
        {"seccomp", 3, {UINT, UINT, ADDR}, LONG},
        {"getrandom", 3, {ADDR, ULONG, UINT}, LONG},
        {"memfd_create", 2, {ADDR, INT}, LONG},
        {"kexec_file_load", 5, {INT, INT, ULONG, ADDR, ULONG}, LONG},
        {"bpf", 3, {INT, ADDR, UINT}, LONG},
        {"_execveat", 5, {INT, ADDR, ADDR, ADDR, INT}, LONG},
        {"faultfd", 1, {INT}, LONG},
        {"arrier", 2, {INT, INT}, LONG},
        {"k2", 3, {ULONG, ULONG, INT}, LONG},
        {"_file_range", 6, {INT, ADDR, INT, ADDR, ULONG, UINT}, LONG},
        {"dv2", 6, {ULONG, ADDR, ULONG, ULONG, ULONG, INT}, LONG},
        {"tev2", 6, {ULONG, ADDR, ULONG, ULONG, ULONG, INT}, LONG},
        {"_mprotect", 0, {}, LONG},
        {"_alloc", 0, {}, LONG},
        {"_free", 0, {}, LONG},
        {"x", 0, {}, LONG},
        {"getevents", 0, {}, LONG},
    };
    return syscalls_infos[id];
}

int get_arg_offset(int arg_index)
{
    static const int arg_regs[] = {RDI, RSI, RDX, R10, R8, R9};
    return arg_regs[arg_index];
}
